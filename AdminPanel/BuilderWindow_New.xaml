<Window x:Class="AdminPanel.BuilderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        Title="eblanRAT Builder" 
        Height="750" Width="900"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <LinearGradientBrush x:Key="BuilderGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#0f0c29" Offset="0"/>
            <GradientStop Color="#302b63" Offset="0.5"/>
            <GradientStop Color="#24243e" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>

    <Border Background="{StaticResource BuilderGradient}" CornerRadius="16">
        <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="40" ShadowDepth="0" Opacity="0.7"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="70"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Border Grid.Row="0" Background="#1a1625" CornerRadius="16,16,0,0" 
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <StackPanel Orientation="Horizontal" Margin="20,0" VerticalAlignment="Center">
                        <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,15,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#667eea" Offset="0"/>
                                    <GradientStop Color="#764ba2" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="🔨" FontSize="22" HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Stub Builder" FontSize="20" FontWeight="Bold" 
                                     Foreground="White"/>
                            <TextBlock Text="Configure and build your stub" FontSize="10" 
                                     Foreground="#888" Margin="0,-2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <Button Content="✕" Width="40" Height="40" 
                          HorizontalAlignment="Right" Margin="0,0,10,0"
                          Style="{StaticResource ModernButtonStyle}"
                          Click="CloseButton_Click"/>
                </Grid>
            </Border>

            <!-- Main Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="20">
                <StackPanel>
                    <!-- Connection Settings -->
                    <hc:Card Background="#1e1e2e" Margin="0,10" Padding="20">
                        <StackPanel>
                            <TextBlock Text="🌐 CONNECTION SETTINGS" FontSize="16" FontWeight="Bold" 
                                     Foreground="White" Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Server Host" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:TextBox x:Name="HostTextBox" 
                                              hc:InfoElement.Placeholder="e.g., 192.168.1.100"
                                              Style="{StaticResource TextBoxExtend}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Server Port" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:NumericUpDown x:Name="PortNumeric" 
                                                    Value="4444" Minimum="1" Maximum="65535"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </hc:Card>

                    <!-- Persistence Settings -->
                    <hc:Card Background="#1e1e2e" Margin="0,10" Padding="20">
                        <StackPanel>
                            <TextBlock Text="🔒 PERSISTENCE SETTINGS" FontSize="16" FontWeight="Bold" 
                                     Foreground="White" Margin="0,0,0,15"/>
                            
                            <hc:CheckBox x:Name="RegistryPersistence" Content="Registry Run Key" 
                                       Foreground="White" Margin="0,5"/>
                            <hc:CheckBox x:Name="TaskSchedulerPersistence" Content="Task Scheduler (Requires Admin)" 
                                       Foreground="White" Margin="0,5"/>
                            <hc:CheckBox x:Name="StartupFolderPersistence" Content="Startup Folder" 
                                       Foreground="White" Margin="0,5"/>
                        </StackPanel>
                    </hc:Card>

                    <!-- Security Settings -->
                    <hc:Card Background="#1e1e2e" Margin="0,10" Padding="20">
                        <StackPanel>
                            <TextBlock Text="🛡️ SECURITY SETTINGS" FontSize="16" FontWeight="Bold" 
                                     Foreground="White" Margin="0,0,0,15"/>
                            
                            <hc:CheckBox x:Name="AntiVMCheck" Content="Anti-VM Detection" 
                                       Foreground="White" Margin="0,5" IsChecked="True"/>
                            <hc:CheckBox x:Name="AntiDebugCheck" Content="Anti-Debug Protection" 
                                       Foreground="White" Margin="0,5" IsChecked="True"/>
                            <hc:CheckBox x:Name="AntiSandboxCheck" Content="Anti-Sandbox Detection" 
                                       Foreground="White" Margin="0,5" IsChecked="True"/>
                        </StackPanel>
                    </hc:Card>

                    <!-- Features -->
                    <hc:Card Background="#1e1e2e" Margin="0,10" Padding="20">
                        <StackPanel>
                            <TextBlock Text="✨ FEATURES" FontSize="16" FontWeight="Bold" 
                                     Foreground="White" Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <hc:CheckBox Content="Screen Capture" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                    <hc:CheckBox Content="Webcam Access" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                    <hc:CheckBox Content="Audio Capture" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1">
                                    <hc:CheckBox Content="File Manager" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                    <hc:CheckBox Content="Remote Shell" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                    <hc:CheckBox Content="System Info" Foreground="White" 
                                               Margin="0,5" IsChecked="True"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </hc:Card>

                    <!-- Assembly Info -->
                    <hc:Card Background="#1e1e2e" Margin="0,10" Padding="20">
                        <StackPanel>
                            <TextBlock Text="📝 ASSEMBLY INFORMATION" FontSize="16" FontWeight="Bold" 
                                     Foreground="White" Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0">
                                    <TextBlock Text="Product Name" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:TextBox x:Name="ProductNameTextBox" 
                                              hc:InfoElement.Placeholder="System Helper"/>
                                </StackPanel>

                                <StackPanel Grid.Row="0" Grid.Column="2">
                                    <TextBlock Text="Company" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:TextBox x:Name="CompanyTextBox" 
                                              hc:InfoElement.Placeholder="System Tools"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,10,0,0">
                                    <TextBlock Text="Description" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:TextBox x:Name="DescriptionTextBox" 
                                              hc:InfoElement.Placeholder="System Support Agent"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,10,0,0">
                                    <TextBlock Text="Version" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <hc:TextBox x:Name="VersionTextBox" 
                                              hc:InfoElement.Placeholder="1.0.0.0"/>
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,10,0,0">
                                    <TextBlock Text="Icon File (Optional)" Foreground="#aaa" Margin="0,0,0,5"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <hc:TextBox x:Name="IconPathTextBox" Grid.Column="0"
                                                  hc:InfoElement.Placeholder="Select .ico file..."
                                                  IsReadOnly="True"/>
                                        <Button Grid.Column="1" Content="📁 Browse" 
                                              Style="{StaticResource ModernButtonStyle}"
                                              Margin="10,0,0,0" Click="BrowseIcon_Click"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </hc:Card>
                </StackPanel>
            </ScrollViewer>

            <!-- Build Button -->
            <Border Grid.Row="2" Background="#1a1625" CornerRadius="0,0,16,16" Padding="20,15">
                <Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <TextBlock x:Name="BuildStatusText" Text="Ready to build" 
                                 Foreground="#888" VerticalAlignment="Center"/>
                        <hc:LoadingCircle x:Name="BuildLoadingIndicator" 
                                        Width="20" Height="20" Margin="10,0,0,0"
                                        Visibility="Collapsed"/>
                    </StackPanel>

                    <Button x:Name="BuildButton" Content="🚀 BUILD STUB" 
                          HorizontalAlignment="Right"
                          Padding="30,12" FontSize="14" FontWeight="Bold"
                          Click="BuildStub_Click">
                        <Button.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#667eea" Offset="0"/>
                                <GradientStop Color="#764ba2" Offset="1"/>
                            </LinearGradientBrush>
                        </Button.Background>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border" 
                                                  Background="{TemplateBinding Background}" 
                                                  CornerRadius="8" 
                                                  Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" 
                                                                VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
