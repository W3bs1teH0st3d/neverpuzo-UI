<Window x:Class="AdminPanel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        Title="eblanRAT - Remote Administration" 
        Height="800" Width="1400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize">
    
    <Window.Resources>
        <!-- Gradient Background -->
        <LinearGradientBrush x:Key="MainGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#1a1a2e" Offset="0"/>
            <GradientStop Color="#16213e" Offset="0.5"/>
            <GradientStop Color="#0f3460" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- Accent Gradient -->
        <LinearGradientBrush x:Key="AccentGradient" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#e94560" Offset="0"/>
            <GradientStop Color="#ff6b6b" Offset="1"/>
        </LinearGradientBrush>

        <!-- Storyboards for Animations -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>
        
        <Storyboard x:Key="SlideInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" 
                           From="20" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>

    <Border Background="{StaticResource MainGradient}" CornerRadius="12">
        <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Border Grid.Row="0" Background="#1a1a2e" CornerRadius="12,12,0,0" 
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo and Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="20,0">
                        <Border Width="40" Height="40" Background="{StaticResource AccentGradient}" 
                                CornerRadius="8" Margin="0,0,12,0">
                            <TextBlock Text="ER" FontSize="18" FontWeight="Bold" 
                                     Foreground="White" HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="eblanRAT" FontSize="20" FontWeight="Bold" 
                                     Foreground="White"/>
                            <TextBlock Text="Remote Administration Tool" FontSize="10" 
                                     Foreground="#888" Margin="0,-2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Status Info -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" 
                              HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Border Background="#2d2d30" CornerRadius="16" Padding="12,6" Margin="5">
                            <StackPanel Orientation="Horizontal">
                                <Ellipse Width="8" Height="8" Fill="#4ade80" Margin="0,0,8,0"/>
                                <TextBlock x:Name="ServerStatusText" Text="Server Running" 
                                         Foreground="White" FontSize="12"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Background="#2d2d30" CornerRadius="16" Padding="12,6" Margin="5">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ‘¥" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock x:Name="ClientCountLabel" Text="0 clients" 
                                         Foreground="White" FontSize="12"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Background="#2d2d30" CornerRadius="16" Padding="12,6" Margin="5">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="â±ï¸" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock x:Name="UptimeText" Text="00:00:00" 
                                         Foreground="White" FontSize="12"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,10,0">
                        <Button Content="âš™ï¸" Width="40" Height="40" 
                              Style="{StaticResource ModernButtonStyle}"
                              Click="SettingsButton_Click" ToolTip="Settings"/>
                        <Button Content="â€”" Width="40" Height="40" 
                              Style="{StaticResource ModernButtonStyle}"
                              Click="MinimizeButton_Click" ToolTip="Minimize"/>
                        <Button Content="âœ•" Width="40" Height="40" 
                              Style="{StaticResource ModernButtonStyle}"
                              Click="CloseButton_Click" ToolTip="Close"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content -->
            <Grid Grid.Row="1" Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Sidebar -->
                <Border Grid.Column="0" Background="#1e1e2e" CornerRadius="8" Margin="0,0,5,0">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="0" Opacity="0.3"/>
                    </Border.Effect>
                    
                    <StackPanel Margin="10">
                        <Button x:Name="ClientsTab" Content="ðŸ‘¥ Clients" 
                              Style="{StaticResource ModernButtonStyle}"
                              HorizontalAlignment="Stretch" Margin="0,5"
                              Click="ClientsTab_Click"/>
                        
                        <Button x:Name="BuilderTab" Content="ðŸ”¨ Builder" 
                              Style="{StaticResource ModernButtonStyle}"
                              HorizontalAlignment="Stretch" Margin="0,5"
                              Click="BuilderTab_Click"/>
                        
                        <Button x:Name="SettingsTab" Content="âš™ï¸ Settings" 
                              Style="{StaticResource ModernButtonStyle}"
                              HorizontalAlignment="Stretch" Margin="0,5"
                              Click="SettingsTab_Click"/>
                        
                        <Button x:Name="LogsTab" Content="ðŸ“‹ Logs" 
                              Style="{StaticResource ModernButtonStyle}"
                              HorizontalAlignment="Stretch" Margin="0,5"
                              Click="LogsTab_Click"/>
                        
                        <Separator Margin="0,20" Background="#333"/>
                        
                        <TextBlock Text="STATISTICS" Foreground="#666" FontSize="10" 
                                 Margin="5,10,0,5" FontWeight="Bold"/>
                        
                        <StackPanel Margin="5">
                            <TextBlock Foreground="#aaa" FontSize="11" Margin="0,3">
                                <Run Text="Total Connections:"/>
                                <Run Text="0" Foreground="White" FontWeight="Bold"/>
                            </TextBlock>
                            <TextBlock x:Name="NetworkTrafficText" Foreground="#aaa" FontSize="11" Margin="0,3">
                                <Run Text="Traffic:"/>
                                <Run Text="0 KB/s" Foreground="White" FontWeight="Bold"/>
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Content Area -->
                <Border Grid.Column="1" Background="#1e1e2e" CornerRadius="8" Margin="5,0,0,0">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="0" Opacity="0.3"/>
                    </Border.Effect>
                    
                    <Grid>
                        <!-- Clients View -->
                        <Grid x:Name="ClientsView" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Toolbar -->
                            <Border Grid.Row="0" Background="#252530" Padding="15,10" 
                                  CornerRadius="8,8,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ”" FontSize="16" VerticalAlignment="Center" 
                                             Margin="0,0,10,0"/>
                                    <hc:SearchBar x:Name="SearchBox" Width="300" 
                                                Style="{StaticResource SearchBarPlus}"
                                                hc:InfoElement.Placeholder="Search clients..."/>
                                    
                                    <Separator Width="1" Margin="20,0" Background="#333"/>
                                    
                                    <Button Content="ðŸ”„ Refresh" Style="{StaticResource ModernButtonStyle}" 
                                          Margin="5,0"/>
                                    <Button Content="ðŸ“Š Export" Style="{StaticResource ModernButtonStyle}" 
                                          Margin="5,0"/>
                                </StackPanel>
                            </Border>

                            <!-- Clients DataGrid -->
                            <DataGrid x:Name="ClientsDataGrid" Grid.Row="1" 
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Foreground="White"
                                    GridLinesVisibility="None"
                                    HeadersVisibility="Column"
                                    SelectionMode="Single"
                                    Margin="10">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Country" Binding="{Binding Country}" Width="60"/>
                                    <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="140"/>
                                    <DataGridTextColumn Header="Computer Name" Binding="{Binding ComputerName}" Width="150"/>
                                    <DataGridTextColumn Header="Username" Binding="{Binding Username}" Width="120"/>
                                    <DataGridTextColumn Header="OS" Binding="{Binding OperatingSystem}" Width="120"/>
                                    <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="80"/>
                                    <DataGridTextColumn Header="Ping" Binding="{Binding Ping}" Width="80"/>
                                    <DataGridTextColumn Header="Connected" Binding="{Binding ConnectedAt}" Width="140"/>
                                </DataGrid.Columns>
                                
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ðŸ–¥ï¸ Remote Desktop" Click="RemoteDesktop_Click"/>
                                        <MenuItem Header="ðŸ“ File Manager" Click="FileManager_Click"/>
                                        <MenuItem Header="ðŸ’» Remote Shell" Click="RemoteShell_Click"/>
                                        <Separator/>
                                        <MenuItem Header="ðŸ“· Webcam" Click="Webcam_Click"/>
                                        <MenuItem Header="ðŸŽ¤ Microphone" Click="Microphone_Click"/>
                                        <Separator/>
                                        <MenuItem Header="â„¹ï¸ System Info" Click="SystemInfo_Click"/>
                                        <MenuItem Header="âš™ï¸ Process Manager" Click="ProcessManager_Click"/>
                                        <Separator/>
                                        <MenuItem Header="ðŸ”Œ Disconnect" Click="DisconnectClient_Click"/>
                                        <MenuItem Header="ðŸ—‘ï¸ Uninstall" Click="UninstallClient_Click"/>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                            </DataGrid>
                        </Grid>

                        <!-- Settings Panel -->
                        <Grid x:Name="SettingsPanel" Visibility="Collapsed">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel Margin="30">
                                    <TextBlock Text="SERVER SETTINGS" FontSize="24" FontWeight="Bold" 
                                             Foreground="White" Margin="0,0,0,20"/>
                                    
                                    <hc:UniformSpacingPanel Spacing="20" Orientation="Vertical">
                                        <!-- Listen Port -->
                                        <Border Background="#252530" CornerRadius="8" Padding="20">
                                            <StackPanel>
                                                <TextBlock Text="Listen Port" FontSize="14" Foreground="White" 
                                                         Margin="0,0,0,10"/>
                                                <hc:NumericUpDown x:Name="ListenPortTextBox" 
                                                                Value="4444" Minimum="1" Maximum="65535"
                                                                Width="200" HorizontalAlignment="Left"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Server Control -->
                                        <Border Background="#252530" CornerRadius="8" Padding="20">
                                            <StackPanel>
                                                <TextBlock Text="Server Control" FontSize="14" Foreground="White" 
                                                         Margin="0,0,0,10"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button x:Name="StartListeningButton" Content="â–¶ï¸ Start Server" 
                                                          Style="{StaticResource ModernButtonStyle}"
                                                          Click="StartListening_Click" Margin="0,0,10,0"/>
                                                    <Button x:Name="StopListeningButton" Content="â¹ï¸ Stop Server" 
                                                          Style="{StaticResource ModernButtonStyle}"
                                                          Click="StopListening_Click" IsEnabled="False"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </hc:UniformSpacingPanel>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>

                        <!-- Logs Panel -->
                        <Grid x:Name="LogsPanel" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="#252530" Padding="15,10" 
                                  CornerRadius="8,8,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹ Activity Logs" FontSize="16" FontWeight="Bold" 
                                             Foreground="White" VerticalAlignment="Center"/>
                                    <Button Content="ðŸ—‘ï¸ Clear" Style="{StaticResource ModernButtonStyle}" 
                                          Margin="20,0,0,0"/>
                                </StackPanel>
                            </Border>

                            <hc:ScrollViewer Grid.Row="1" Margin="10">
                                <ItemsControl x:Name="LogsItemsControl">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#252530" CornerRadius="4" 
                                                  Padding="10" Margin="0,2">
                                                <TextBlock Text="{Binding}" Foreground="#ccc" 
                                                         TextWrapping="Wrap"/>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </hc:ScrollViewer>
                        </Grid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
